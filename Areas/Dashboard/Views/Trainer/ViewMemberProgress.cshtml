@model FitnessManagementSystem.ViewModels.MemberProgressViewModel

@{
    ViewData["Title"] = "Member Progress";
    Layout = "~/Areas/Dashboard/Views/_Layout.cshtml";
}
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.8/js/bootstrap.min.js" integrity="sha512-nKXmKvJyiGQy343jatQlzDprflyB5c+tKCzGP3Uq67v+lmzfnZUi/ZT+fc6ITZfSC5HhaBKUIvr/nTLCV+7F+Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<div class="container">
    <h2 class="my-4">Progress for @ViewBag.MemberName</h2>

    <ul class="nav nav-tabs" id="progressTab" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="workouts-tab" data-bs-toggle="tab" href="#workouts"
               role="tab" aria-controls="workouts" aria-selected="true">Workout History</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="stats-tab" data-bs-toggle="tab" href="#stats"
               role="tab" aria-controls="stats" aria-selected="false">Body Stats</a>
        </li>
    </ul>


    <div class="tab-content mt-3" id="progressTabContent">
        <!-- Workout History Tab -->
        <div class="tab-pane fade show active" id="workouts" role="tabpanel" aria-labelledby="workouts-tab">
            @if (!Model.WorkoutSessions.Any())
            {
                <div class="alert alert-info">No workouts logged by this member yet.</div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Duration (mins)</th>
                                <th>Calories</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var session in Model.WorkoutSessions)
                            {
                                <tr>
                                    <td>@session.SessionDate.ToString("g")</td>
                                    <td>@($"{session.User.FirstName} {session.User.LastName}")</td>
                                    <td>@session.DurationMinutes</td>
                                    <td>@session.CaloriesBurned</td>
                                    <td>@session.Notes</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
        </div>

        <!-- Body Stats Tab -->
        <div class="tab-pane fade" id="stats" role="tabpanel" aria-labelledby="stats-tab">
            @if (!Model.ProgressRecords.Any())
            {
                <div class="alert alert-info">No progress records found for this member.</div>
            }
            else
            {
                <div class="table-responsive">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Name</th>
                                <th>Weight (kg)</th>
                                <th>BMI</th>
                                <th>Body Fat %</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var record in Model.ProgressRecords)
                            {
                                <tr>
                                    <td>@record.RecordedAt.ToString("d")</td>
                                    <td>@($"{record.User.FirstName} {record.User.LastName}")</td>
                                    <td>@record.Weight</td>
                                    <td>@record.BMI</td>
                                    <td>@record.BodyFatPercentage</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
        </div>
    </div>
    
    <a asp-action="Dashboard" class="btn btn-secondary mt-3">Back to Dashboard</a>
</div>
